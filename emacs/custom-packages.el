(defun ensure-package-installed (&rest packages)
  "Assure every package is installed, ask for installation if itâ€™s not.
Return a list of installed packages or nil for every skipped package."
  (mapcar
   (lambda (package)
     ;; (package-installed-p 'evil)
     (if (package-installed-p package)
         nil
       (if (y-or-n-p (format "Package %s is missing. Install it? " package))
           (package-install package)
         package)))
   packages))

;; make sure to have downloaded archive description.
;; Or use package-archive-contents as suggested by Nicolas Dudebout
(or (file-exists-p package-user-dir)
    (package-refresh-contents))

(ensure-package-installed 'ac-etags 'ac-inf-ruby 'ac-ispell 'ac-js2 'achievements 'ack-and-a-half 'aes 'alpha 'android-mode 'angry-police-captain 'apache-mode 'apt-utils-ido 'apt-utils 'arduino-mode 'auto-capitalize 'auto-compile 'auto-complete-c-headers 'auto-complete 'auto-dictionary 'auto-highlight-symbol 'auto-indent-mode 'auto-save-buffers-enhanced 'auto-shell-command 'autopair 'awk-it 'backtrace-mode 'bar-cursor 'bbdb- 'bbdb-ext 'bbdb 'bind-key 'bitly 'browse-url-dwim 'bundler 'butler 'c-eldoc 'calfw 'calfw-gcal 'capture 'cedit 'charmap 'chess 'circe 'clojure-mode 'cmake-mode 'cmake-project 'code-headers 'coffee-mode 'column-enforce-mode 'columnify 'confluence 'cperl-mode 'cppcheck 'crab 'crontab-mode 'csharp-mode 'css-eldoc 'csv-mode 'ctags 'ctags-update 'dart-mode 'dedicated 'diff-git 'diff-hl 'dired+ 'dired-details+ 'dired-details 'dired-efap 'dired-isearch 'dired-rainbow 'dired-hacks-utils 'dired-single 'dired-toggle 'dired-toggle-sudo 'disaster 'dna-mode 'doc-mode 'docbook 'dom 'dropbox 'dropdown-list 'dtrt-indent 'dummy-h-mode 'easy-kill 'ecb 'editorconfig 'eimp 'eldoc-eval 'eldoc-extension 'electric-case 'elfeed 'elnode 'db 'creole 'emms-info-mediainfo 'emms-mark-ext 'emms-soundcloud 'enh-ruby-mode 'epresent 'eproject 'erc-hl-nicks 'erc-image 'erc-tweet 'eredis 'erlang 'esxml 'evernote-mode 'facebook 'fakir 'fixmee 'back-button 'button-lock 'flymake-checkers 'flymake-coffee 'flymake-css 'flymake-csslint 'flymake-cursor 'flymake-go 'flymake 'flymake-haml 'flymake-haskell-multi 'flymake-jshint 'flymake-jslint 'flymake-json 'flymake-less 'flymake-lua 'flymake-php 'flymake-phpcs 'flymake-puppet 'flymake-ruby 'flymake-sass 'flymake-shell 'flymake-yaml 'flymake-easy 'flyspell-lazy 'fm 'fold-dwim 'fold-this 'font-lock+ 'font-utils 'framemove 'free-keys 'fringe-current-line 'fullscreen-mode 'gccsense 'gdb-shell 'geben 'gist 'gh 'git-blame 'git-commit 'git-commit-training-wheels-mode 'git-dwim 'git-gutter+ 'git-gutter-fringe 'git-gutter 'gitattributes-mode 'gitconfig-mode 'github-browse-file 'gitignore-mode 'gnuplot 'gnuplot-mode 'go-mode 'google-c-style 'google-contacts 'google-maps 'google-this 'google-translate 'google-weather 'gplusify 'grizzl 'groovy-mode 'hackernews 'ham-mode 'handlebars-mode 'haskell-mode 'helm 'heroku 'highlight 'highlight-80+ 'highlight-current-line 'highlight-escape-sequences 'highlight-indentation 'highlight-parentheses 'highlight-symbol 'highlight-unique-symbol 'howdoi 'html-to-markdown 'httpcode 'httpd 'httprepl 'idle-highlight-mode 'ido-complete-space-or-hyphen 'ido-gnus 'ido-hacks 'ido-yes-or-no 'image+ 'image-dired+ 'imgur 'anything 'indicators 'inf-mongo 'inf-php 'jabber 'jade-mode 'java-file-create 'javap 'javap-mode 'javarun 'jenkins-watch 'jira 'jquery-doc 'js-comint 'js2-refactor 'js3-mode 'json-mode 'jss 'keyfreq 'know-your-http-well 'kv 'lcs 'legalese 'less-css-mode 'linum-off 'linum-relative 'log4e 'logito 'lolcode-mode 'look-mode 'lorem-ipsum 'lua-mode 'lui 'magit-commit-training-wheels 'malabar-mode 'fringe-helper 'mc-extras 'minimap 'mode-compile 'mode-icons 'mongo 'multi-term 'multi-web-mode 'multiple-cursors 'muse 'mustache-mode 'nanowrimo 'nav-flash 'newsticker 'nginx-mode 'nodejs-repl 'noflet 'nxml-mode 'nyan-mode 'oauth2 'octomacs 'offlineimap 'openwith 'org-bullets 'org-jekyll 'org-jira 'org-octopress 'ctable 'org-pomodoro 'alert 'org-present 'orglue 'org-mac-link 'epic 'outline-magic 'packed 'magit 'git-rebase-mode 'git-commit-mode 'paredit-everywhere 'paredit 'paren-face 'parenface-plus 'parse-csv 'perl-completion 'perl-myvar 'perlcritic 'perspective 'pgdevenv 'php+-mode 'php-auto-yasnippets 'php-boris 'php-eldoc 'php-extras 'php-mode 'pomodoro 'popup 'popwin 'pretty-mode 'processing-mode 'project 'project-explorer 'es-windows 'es-lib 'project-mode 'levenshtein 'projectile-rails 'f 'projectile 'pkg-info 'epl 'prolog 'puppet-mode 'puppetfile-mode 'pylint 'pymacs 'python 'python-info 'python-pep8 'python-pylint 'railgun 'rainbow-delimiters 'rainbow-mode 'rbenv 'rcirc-color 'rcirc-notify 'rect+ 'rect-mark 'regex-tool 'requirejs-mode 'restclient 'rfringe 'rhtml-mode 'rinari 'jump 'inflections 'findr 'robe 'rsense 'rspec-mode 'rtags 'ruby-additional 'ruby-block 'ruby-compilation 'inf-ruby 'ruby-dev 'ruby-electric 'ruby-end 'ruby-hash-syntax 'ruby-interpolation 'ruby-refactor 'ruby-test-mode 'ruby-tools 'sass-mode 'haml-mode 'ruby-mode 'scala-mode 'scratch 'screenshot 'scss-mode 'shell-command 'shell-here 'show-css 'simplezen 's 'skewer-mode 'js2-mode 'simple-httpd 'skype 'smart-compile 'smart-mode-line 'smart-tab 'smart-tabs-mode 'smarter-compile 'smartparens 'dash 'smartrep 'sml-mode 'sml-modeline 'sos 'org 'soundcloud 'deferred 'emms 'sparkline 'ssh-config-mode 'string-utils 'strings 'stripe-buffer 'stylus-mode 'sudo-ext 'sudoku 'sws-mode 'syslog-mode 'hide-lines 'tabula-rasa-mode 'tdd-status-mode-line 'tea-time 'test-case-mode 'thesaurus 'time-ext 'timestamper 'tomatinho 'top-mode 'tracking 'shorten 'tumble 'http-post-simple 'tumblesocks 'markdown-mode 'oauth 'htmlize 'twitter 'twittering-mode 'ucs-utils 'persistent-soft 'list-utils 'pcache 'unbound 'vagrant 'virtualenv 'volume 'w3 'w3m 'watch-buffer 'wc-mode 'weather 'weather-metno 'web 'websocket 'wget 'window-jump 'window-layout 'window-number 'worklog 'workspaces 'writegood-mode 'writeroom-mode 'wtf 'xclip 'xkcd 'xlicense 'xml-gen 'xml-rpc 'xmlgen 'yagist 'yaml-mode 'yard-mode 'yas-jit 'yasnippet 'yaxception 'zen-mode 'zencoding-mode 'zlc) ;  --> (nil nil) if iedit and magit are already installed

;; activate installed packages
(package-initialize)
